# Writeup : heap 1

## Objective

The goal of this challenge is to manipulate the `safe_var` variable to change its value to `"pico"` in order to trigger the win condition and print the flag.

## Vulnerability Analysis

Upon analyzing the provided C code, I identified a buffer overflow vulnerability in the `write_buffer` function. The function allows writing user input to a buffer (`input_data`) without proper bounds checking.

## Initial Heap State

When the program starts, it prints the initial state of the heap:

Heap State:

Address -> Heap Data

0x5575ae0836b0 -> pico

0x5575ae0836d0 -> bico


From the heap addresses, we can infer that:
- `input_data` is allocated first.
- `safe_var` is allocated next, at a higher memory address.

## Exploit Strategy

To exploit this vulnerability, I need to overflow the `input_data` buffer to overwrite the `safe_var` buffer. The addresses suggest that the `safe_var` buffer is immediately after `input_data` in memory.

## Crafting the Payload

Based on the heap addresses:
- The address difference between `input_data` and `safe_var` suggests a buffer size of 32 bytes between the start of `input_data` and the start of `safe_var`.

Thus, to overflow `input_data` and modify `safe_var`, I crafted a payload that fills `input_data` and then overwrites `safe_var`:

`01234567890123456789012345678901pico`

This payload consists of 32 filler characters followed by `"pico"`.

## Steps to Exploit

1. **Start the Program**:
   - Run the program to initialize the heap and print the initial state.

2. **Select Option to Write to Buffer**:
   - Choose the option to write to the buffer (`input_data`).

3. **Provide the Payload**:
   - Input the crafted payload: `01234567890123456789012345678901pico`.

4. **Check for Win Condition**:
   - Select the option to print the flag. If the exploit is successful, the `safe_var` will be `"pico"`, and the program will print the flag.
